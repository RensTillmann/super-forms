jQuery,jQuery(document).ready(function(p){var a=p(document);p(window).bind("tb_unload",function(){p(".super-add-item > *:not(.super-msg)").show(),p(".super-add-item .super-msg").html("").removeClass("super-error").removeClass("super-success")}),a.on("click",".star-rating > .star",function(){var s=p(this);if(s.parents(".plugin-card:eq(0)").hasClass("owned")){if(!s.parent().hasClass("submitted")){s.parent().addClass("submitted");var r=s.index(),a=s.parents(".plugin-card:eq(0)").data("id");p.ajax({type:"post",url:ajaxurl,data:{action:"super_marketplace_rate_item",item:a,rating:r},success:function(a){var t=jQuery.parseJSON(a);if(0!=t.error)alert(t.msg);else{var e=s.parents(".column-rating:eq(0)").children(".num-ratings").text();e=e.replace("(","").replace(")",""),e=parseFloat(e)+1,s.parents(".column-rating:eq(0)").children(".num-ratings").text("("+e+")"),s.parent().children(".star").each(function(){p(this).index()<=r?p(this).attr("class","star star-full").attr("data-old-class","star star-full"):p(this).attr("class","star star-empty").attr("data-old-class","star star-empty")})}}})}}else alert("You do not own this form, rating is disabled!")}),a.on("mouseover",".star-rating > .star",function(){var a=p(this);if(!a.parent().hasClass("submitted")){var t=a.index();a.parent().children(".star").each(function(){p(this).index()<=t?(void 0===p(this).attr("data-old-class")&&p(this).attr("data-old-class",p(this).attr("class")),p(this).attr("class","star star-full")):"undefined"!==p(this).attr("data-old-class")&&p(this).attr("class","star star-empty")})}}),a.on("mouseleave",".column-rating",function(){p(this).children(".star-rating").hasClass("submitted")||p(this).find(".star-rating > .star").each(function(){void 0!==p(this).attr("data-old-class")&&p(this).attr("class",p(this).attr("data-old-class"))})}),a.on("click",".generated-tags > span",function(){p(this).remove();var a="",t=0;p(".generated-tags > span").each(function(){a+=0==t?p(this).text():", "+p(this).text(),t++}),p('.super-add-item input[name="tags"]').val(a)}),a.on("keyup keydown",'.super-add-item input[name="tags"]',function(){var a=p(this).val().split(/[ ,]+/),e="",s=0,r={};p.each(a,function(a,t){void 0===r[t]&&++s<=5&&""!=(t=t.replace(/ /g,""))&&1<t.length&&(e+="<span>"+t+"</span>"),r[t]=t}),p(".super-add-item .generated-tags").html(e)}),a.on("click",".super-marketplace .purchase-now",function(){var s=p(this);if(!s.hasClass("button-disabled")){var r=s.html();s.html("Loading...").addClass("button-disabled");var t=s.parents(".plugin-card:eq(0)").data("id");p.ajax({type:"post",url:ajaxurl,data:{action:"super_marketplace_purchase_item",item:t},success:function(a){window.location.href="https://f4d.nl/super-forms/?api=marketplace-purchase-item&item="+t+"&user="+a+"&return-url="+window.location.href},error:function(a,t,e){s.html(r),alert(super_marketplace_i18n.connection_lost)}})}}),a.on("click",".super-marketplace .install-now",function(){var a=p(this);if(!a.hasClass("button-disabled")){a.html(),a.html("Installing...").addClass("button-disabled");var t=a.parents(".plugin-card:eq(0)"),e=t.find('input[name="title"]').val(),s=t.find('textarea[name="_super_elements"]').val(),r=t.find('textarea[name="_super_form_settings"]').val(),n=t.find('textarea[name="_super_import"]').val();p.ajax({type:"post",url:ajaxurl,data:{action:"super_marketplace_install_item",title:e,elements:s,settings:r,import:n},success:function(a){window.location.href="admin.php?page=super_create_form&id="+a},error:function(a,t,e){alert(super_marketplace_i18n.connection_lost)}})}}),a.on("click",".super-add-item .super-submit",function(){var a,t=p(this),e=t.html(),s=!1;if(p(".super-add-item label").removeClass("error"),""==(a=p('select[name="forms"]')).val()&&(s=!0,a.parents("label:eq(0)").addClass("error")),10<(a=p('input[name="price"]')).val()&&(s=!0,a.parents("label:eq(0)").addClass("error")),0<p('input[name="price"]').val()&&((a=p('input[name="paypal"]')).val().length<4||!/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(a.val()))&&(s=!0,a.parents("label:eq(0)").addClass("error")),((a=p('input[name="email"]')).val().length<4||!/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(a.val()))&&(s=!0,a.parents("label:eq(0)").addClass("error")),0==s){var r=p('select[name="forms"]').val(),n=p('input[name="price"]').val(),i=p('input[name="paypal"]').val(),l=p('input[name="email"]').val(),o={};p(".generated-tags > span").each(function(){o[p(this).text()]=p(this).text()}),t.html("Loading..."),p.ajax({type:"post",url:ajaxurl,data:{action:"super_marketplace_add_item",form:r,price:n,paypal:i,email:l,tags:o},success:function(a){var t=jQuery.parseJSON(a),e=p(".super-add-item .super-msg");1==t.error?e.removeClass("super-success").addClass("super-error").html(t.msg):t.redirect?window.location.href=t.redirect:(p(".super-add-item > *:not(.super-msg)").hide(),e.removeClass("super-error").addClass("super-success").html(t.msg))},complete:function(){t.html(e)},error:function(a,t,e){alert(super_marketplace_i18n.connection_lost)}})}}),a.on("click",".report",function(){var t=p(this);if(!t.hasClass("reported")){var a=prompt(super_marketplace_i18n.reason+":","");if(2<a.length){var e=t.parents(".plugin-card:eq(0)").data("id");p.ajax({type:"post",url:ajaxurl,data:{action:"super_marketplace_report_abuse",id:e,reason:a},success:function(a){t.addClass("reported").html("Reported!")},error:function(a,t,e){alert(super_marketplace_i18n.connection_lost)}})}else alert(super_marketplace_i18n.reason_empty)}})});