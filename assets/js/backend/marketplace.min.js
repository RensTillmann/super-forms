jQuery(document).ready(function ($) {
    
    var $doc = $(document);

    $doc.on('click', '.report', function(){
        var $this = $(this);
        if(!$this.hasClass('reported')){
            var $reason = prompt(super_marketplace_i18n.reason+':', '');
            if($reason.length > 2){
                var $id = $this.parents('.plugin-card:eq(0)').data('id');
                $.ajax({
                    type: 'post',
                    url: ajaxurl,
                    data: {
                        action: 'super_marketplace_report_abuse',
                        id: $id,
                        reason: $reason
                    },
                    success: function (result) {
                        $this.addClass('reported').html('Reported!');
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        alert(super_marketplace_i18n.connection_lost);
                    }
                });
            }else{
                alert(super_marketplace_i18n.reason_empty);
            }
        }
    });

});